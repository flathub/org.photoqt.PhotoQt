app-id: org.photoqt.PhotoQt
runtime: org.kde.Platform
runtime-version: 6.6
sdk: org.kde.Sdk
command: photoqt
finish-args:
    - --share=ipc
    - --socket=wayland
    - --socket=fallback-x11
    - --filesystem=host
    - --device=dri
    - --socket=pulseaudio
cleanup:
    - /include
    - /lib/pkgconfig
    - /share/doc
    - /share/man
    - '*.a'
    - '*.la'
modules:
    ########################
    - name: exiv2
      buildsystem: cmake-ninja
      builddir: true
      config-opts:
        - -DEXIV2_ENABLE_INIH=OFF
        - -DEXIV2_BUILD_SAMPLES=OFF
        - -DEXIV2_BUILD_EXIV2_COMMAND=OFF
        - -DEXIV2_ENABLE_BMFF=ON
      cleanup:
        - /bin
        - /share/man
      sources:
        - type: git
          url: https://github.com/Exiv2/exiv2
          tag: v0.28.1
    ########################
    - name: libraw
      builddir: true
      config-opts: --disable-examples
      sources:
        - type: git
          url: https://github.com/LibRaw/LibRaw
          tag: 0.21.1
        - type: shell
          commands: ["autoreconf -vfi"]
    ########################
    - name: imagemagick
      builddir: true
      config-opts:
        - --enable-shared
        - --disable-static
        - --disable-docs
        - --with-modules
        - --with-threads
        - --with-png
      cleanup: /bin/GraphicsMagick*config
      sources:
        - type: git
          url: https://github.com/ImageMagick/ImageMagick
          tag: 7.1.1-23
    ########################
    - name: devil
      buildsystem: cmake-ninja
      subdir: DevIL
      builddir: true
      sources:
        - type: archive
          url: https://sourceforge.net/projects/openil/files/DevIL/1.8.0/DevIL-1.8.0.tar.gz
          sha256: 0075973ee7dd89f0507873e2580ac78336452d29d34a07134b208f44e2feb709
    ########################
    - name: pugixml
      buildsystem: cmake-ninja
      builddir: true
      config-opts:
        - -DBUILD_TESTING=OFF
      sources:
        - type: git
          url: https://github.com/zeux/pugixml
          tag: v1.14
    ########################
    - name: photoqt
      buildsystem: cmake-ninja
      builddir: true
      config-opts:
        - -DIMAGEMAGICK=ON
        - -DGRAPHICSMAGICK=OFF
        - -DEXIV2=ON
        - -DLIBARCHIVE=ON
        - -DRAW=ON
        - -DPOPPLER=OFF
        - -DQTPDF=OFF
        - -DDEVIL=ON
        - -DFREEIMAGE=OFF
        - -DPUGIXML=ON
        - -DCHROMECAST=OFF
        - -DLIBVIPS=OFF
        - -DVIDEO_MPV=OFF
      sources:
        - type: git
          url: https://gitlab.com/lspies/photoqt.git
          tag: v4.0
